(window.webpackJsonp=window.webpackJsonp||[]).push([[4,2],{541:function(e,t,r){"use strict";r.r(t);var o={name:"VideoTrack",props:{track:{type:Object,required:!0}},mounted:function(){var e=this.track.attach();e.style.width="100%",this.$refs.videoContainer.appendChild(e)}},n=r(70),component=Object(n.a)(o,(function(){var e=this.$createElement;return(this._self._c||e)("div",{ref:"videoContainer"})}),[],!1,null,null,null);t.default=component.exports},652:function(e,t,r){var content=r(803);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(61).default)("72d04510",content,!0,{sourceMap:!1})},769:function(e,t){},770:function(e,t){},779:function(e,t){},801:function(e,t,r){e.exports=r.p+"videos/virtual-background.9c2e432.mp4"},802:function(e,t,r){"use strict";r(652)},803:function(e,t,r){var o=r(60),n=r(804),c=r(805),l=o(!1),d=n(c);l.push([e.i,".transparent-background video{background-image:url("+d+");background-repeat:repeat}",""]),e.exports=l},805:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAIAAAAC64paAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAL0lEQVQ4jWPcvn07A27g4eGBR5YJjxxBMKp5ZGhm/P//Px7pHTt20MrmUc0jQzMAeNIISQS+Yf0AAAAASUVORK5CYII="},823:function(e,t,r){"use strict";r.r(t);r(9),r(47),r(48),r(32);var o=r(122),n=r(541),c=r(20),l=(r(81),r(655)),d=r.n(l);function v(){var e=Object(o.b)(null),t=function(){var t=Object(c.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.value){t.next=2;break}return t.abrupt("return",e.value);case 2:return t.next=4,d.a.createLocalVideoTrack();case 4:return e.value=t.sent,t.abrupt("return",e.value);case 6:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return{localVideoTrack:e,getLocalVideoTrack:t}}var m=r(16),k=r(24),f=r(25),h=(r(392),r(817),r(818)),V=r(540),T=r(800),x=r(801),w=r.n(x);function A(canvas,video){var e=canvas.getContext("2d"),t=video.videoWidth,r=video.videoHeight,o=Math.max(canvas.width/t,canvas.height/r);e.setTransform(o,0,0,o,canvas.width/2,canvas.height/2),e.drawImage(video,-t/2,-r/2,t,r),e.resetTransform()}var _=function(){function e(t){Object(k.a)(this,e),this.segmenter=t.segmenter,this.fxCanvas=T.canvas(),this.fxTexture=null,this.virtualBackground=document.createElement("video"),this.virtualBackground.autoplay=!0,this.virtualBackground.loop=!0,this.virtualBackground.src=t.virtualBackgroundPath||w.a,this.compositeSteps=t.compositeSteps||4}var t;return Object(f.a)(e,[{key:"processFrame",value:(t=Object(c.a)(regeneratorRuntime.mark((function e(t,r){var o,n,c,l,mask,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.segmenter.segmentPeople(t);case 2:return o=e.sent,n=Object(m.a)(o,1),c=n[0],e.next=7,c.mask;case 7:if(l=e.sent,mask=l.mask,(d=r.getContext("2d")).globalCompositeOperation="copy",d.drawImage(mask,0,0),!(this.compositeSteps<2)){e.next=14;break}return e.abrupt("return");case 14:if(this.fxTexture?this.fxTexture.loadContentsOf(r):this.fxTexture=this.fxCanvas.texture(r),this.fxCanvas.draw(this.fxTexture).denoise(5).update(),d.drawImage(this.fxCanvas,0,0),d.globalCompositeOperation="destination-in",d.drawImage(mask,0,0),!(this.compositeSteps<3)){e.next=21;break}return e.abrupt("return");case 21:if(d.globalCompositeOperation="source-in",d.drawImage(t,0,0),!(this.compositeSteps<4)){e.next=25;break}return e.abrupt("return");case 25:d.globalCompositeOperation="destination-over",A(r,this.virtualBackground);case 27:case"end":return e.stop()}}),e,this)}))),function(e,r){return t.apply(this,arguments)})}]),e}();var C=Object(o.b)(h.b(h.a.MediaPipeSelfieSegmentation,{runtime:"mediapipe",modelType:"landscape",solutionPath:"https://cdn.jsdelivr.net/npm/@mediapipe/selfie_segmentation@".concat(V.VERSION)}));function S(track){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,t=Object(o.b)(null),r=function(){var r=Object(c.a)(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(t.value){r.next=8;break}return r.t0=_,r.next=4,C.value;case 4:r.t1=r.sent,r.t2=e,r.t3={segmenter:r.t1,compositeSteps:r.t2},t.value=new r.t0(r.t3);case 8:track.value.processor&&track.value.removeProcessor(track.value.processor),track.value.addProcessor(t.value);case 10:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();return{startVirtualBackground:r}}var B={name:"IndexPage",components:{VideoTrack:n.default},middleware:["checkBrowserSupport"],setup:function(){var e=Object(o.b)(!1),t=v(),r=t.localVideoTrack,n=t.getLocalVideoTrack,c=v(),l=c.localVideoTrack,d=c.getLocalVideoTrack,m=v(),k=m.localVideoTrack,f=m.getLocalVideoTrack,h=v(),V=h.localVideoTrack,T=h.getLocalVideoTrack,x=v(),w=x.localVideoTrack,A=x.getLocalVideoTrack,_=S(l).startVirtualBackground,C=S(k,1).startVirtualBackground,B=S(V,2).startVirtualBackground,O=S(w,3).startVirtualBackground;Promise.all([n(),d(),f(),T(),A()]).then((function(){_(),C(),B(),O()}));var j=[k,V,w];return{showCompositeSteps:e,toggleCompositeSteps:function(){e.value=!e.value,j.forEach((function(track){e.value?track.value.restart():track.value.stop()}))},rawVideoTrack:r,composite1VideoTrack:k,composite2VideoTrack:V,composite3VideoTrack:w,virtualBackgroundVideoTrack:l}}},O=(r(802),r(70)),j=r(116),I=r.n(j),P=r(822),R=r(820),y=r(821),component=Object(O.a)(B,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("v-row",[r("v-col",{attrs:{cols:"12",xs:"12",sm:"6"}},[e.rawVideoTrack?r("VideoTrack",{attrs:{track:e.rawVideoTrack}}):e._e(),e._v(" "),r("h1",[e._v("Source")])],1),e._v(" "),r("v-col",{attrs:{cols:"12",xs:"12",sm:"6"}},[e.virtualBackgroundVideoTrack?r("VideoTrack",{attrs:{track:e.virtualBackgroundVideoTrack}}):e._e(),e._v(" "),r("h1",[e._v("Final")])],1)],1),e._v(" "),r("v-row",[r("v-col",[r("v-btn",{on:{click:e.toggleCompositeSteps}},[e._v("\n        "+e._s(e.showCompositeSteps?"Hide":"Show")+" Composite Steps\n      ")])],1)],1),e._v(" "),e.showCompositeSteps?r("v-row",[r("v-col",{attrs:{cols:"12",xs:"12",sm:"4"}},[e.composite1VideoTrack?r("VideoTrack",{staticClass:"transparent-background",attrs:{track:e.composite1VideoTrack}}):e._e(),e._v(" "),r("h3",[e._v("Segmentation mask")])],1),e._v(" "),r("v-col",{attrs:{cols:"12",xs:"12",sm:"4"}},[e.composite2VideoTrack?r("VideoTrack",{staticClass:"transparent-background",attrs:{track:e.composite2VideoTrack}}):e._e(),e._v(" "),r("h3",[e._v("Bilateral filter")])],1),e._v(" "),r("v-col",{attrs:{cols:"12",xs:"12",sm:"4"}},[e.composite3VideoTrack?r("VideoTrack",{staticClass:"transparent-background",attrs:{track:e.composite3VideoTrack}}):e._e(),e._v(" "),r("h3",[e._v("Foreground composite")])],1)],1):e._e()],1)}),[],!1,null,null,null);t.default=component.exports;I()(component,{VideoTrack:r(541).default}),I()(component,{VBtn:P.a,VCol:R.a,VRow:y.a})}}]);